<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart Mentor – Calendar</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="public/css/base.css" />
  <link rel="stylesheet" href="public/css/layout.css" />
  <link rel="stylesheet" href="public/css/components.css" />
  <link rel="stylesheet" href="public/css/calendar.css" />
</head>
<body>
  <div class="app-container">
    <!-- Sidebar (same as before) -->
    <aside class="sidebar" id="sidebar" role="navigation" aria-label="Main navigation">
      <div class="sidebar__header">
        <div class="sidebar__brand">
          <svg class="sidebar__brand-icon" width="32" height="32" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path></svg>
          <div class="sidebar__brand-text"><h1 class="sidebar__brand-title">Smart Mentor</h1><span class="sidebar__brand-subtitle">Academic Companion</span></div>
        </div>
        <button class="sidebar__toggle" id="sidebar-toggle" aria-label="Toggle sidebar" aria-expanded="true" aria-controls="sidebar"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
      </div>
      <nav class="sidebar__nav">
        <ul class="sidebar__nav-list" role="list">
          <li class="sidebar__nav-item"><a href="index.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg><span>Dashboard</span></a></li>
          <li class="sidebar__nav-item"><a href="assignments.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg><span>Assignments</span></a></li>
          <li class="sidebar__nav-item"><a href="timetable.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg><span>Timetable</span></a></li>
          <li class="sidebar__nav-item"><a href="progress.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg><span>Progress</span></a></li>
          <li class="sidebar__nav-item"><a href="calendar.html" class="sidebar__nav-link sidebar__nav-link--active" aria-current="page"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line><rect x="7" y="14" width="3" height="3"></rect></svg><span>Calendar</span></a></li>
          <li class="sidebar__nav-item"><a href="subjects.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg><span>Subjects</span></a></li>
          <li class="sidebar__nav-item"><a href="learning-path.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M3 3h18v4H3z"></path><path d="M7 7v14"></path></svg><span>Learning Path</span></a></li>
          <li class="sidebar__nav-item"><a href="assessment.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><rect x="3" y="3" width="18" height="14" rx="2"></rect><path d="M7 7h10M7 11h6"></path></svg><span>Assessment</span></a></li>
          <li class="sidebar__nav-item"><a href="analytics.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg><span>Analytics</span></a></li>
          <li class="sidebar__nav-item"><a href="ai-mentor.html" class="sidebar__nav-link"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg><span>AI Mentor</span></a></li>
        </ul>
      </nav>
      <div class="sidebar__footer">
        <button class="sidebar__action-button chatbot-trigger-button" id="chatbot-trigger" aria-label="Open AI mentor chat"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg><span>AI Mentor</span><span class="sidebar__notification-badge" id="chat-notification" aria-label="Unread messages"></span></button>
        <div class="sidebar__user"><div class="sidebar__user-avatar" aria-hidden="true"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div><div class="sidebar__user-info"><span class="sidebar__user-name">Student</span><span class="sidebar__user-role">Active</span></div></div>
      </div>
    </aside>

    <!-- Main -->
    <div class="main-wrapper">
      <header class="dashboard-header" role="banner">
        <div class="dashboard-header__content">
          <div class="dashboard-header__title-section">
            <h1 class="dashboard-header__title">Calendar</h1>
            <p class="dashboard-header__subtitle">Manage your academic schedule</p>
          </div>
          <div class="dashboard-header__actions">
            <button class="secondary-button" id="calendar-today-btn" aria-label="Go to today">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
              <span>Today</span>
            </button>
            <button class="primary-button" id="add-event-btn" aria-label="Add new event">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
              <span>Add Event</span>
            </button>
            <div class="calendar-view-toggle" role="group" aria-label="Calendar view selector">
              <button class="calendar-view-toggle__button calendar-view-toggle__button--active" data-view="month" aria-pressed="true">Month</button>
              <button class="calendar-view-toggle__button" data-view="week" aria-pressed="false">Week</button>
              <button class="calendar-view-toggle__button" data-view="agenda" aria-pressed="false">Agenda</button>
            </div>
          </div>
        </div>
      </header>

      <main class="dashboard-content" role="main">
        <!-- Calendar Filters -->
        <div class="calendar-filters" role="region" aria-label="Calendar filters">
          <div class="calendar-filters__group">
            <label for="event-type-filter" class="calendar-filters__label">Type:</label>
            <select id="event-type-filter" class="calendar-filters__select">
              <option value="all">All Events</option>
              <option value="task">Assignments</option>
              <option value="class">Classes</option>
              <option value="exam">Exams</option>
              <option value="study">Study Sessions</option>
              <option value="personal">Personal</option>
            </select>
          </div>
          <div class="calendar-filters__group">
            <label for="subject-filter" class="calendar-filters__label">Subject:</label>
            <select id="subject-filter" class="calendar-filters__select">
              <option value="all">All Subjects</option>
            </select>
          </div>
          <div class="calendar-filters__group">
            <input type="search" id="event-search" class="calendar-filters__search" placeholder="Search events..." aria-label="Search events">
          </div>
          <button class="secondary-button calendar-filters__clear" id="clear-filters">Clear Filters</button>
        </div>

        <div class="dashboard-grid dashboard-grid--calendar">
          <!-- Calendar Main View -->
          <section class="dashboard-card dashboard-card--calendar-main" aria-labelledby="calendarMainTitle">
            <div class="dashboard-card__header">
              <div class="dashboard-card__title-group">
                <h2 class="dashboard-card__title" id="calendarMainTitle">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                  <span id="calendar-main-title">Calendar</span>
                </h2>
                <span class="dashboard-card__badge" id="current-period-label">—</span>
              </div>
              <div class="calendar-nav">
                <button class="calendar-nav__button" id="calendar-prev" aria-label="Previous period"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="15 18 9 12 15 6"></polyline></svg></button>
                <button class="calendar-nav__button" id="calendar-next" aria-label="Next period"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="9 18 15 12 9 6"></polyline></svg></button>
              </div>
            </div>
            <div class="dashboard-card__content calendar-view-container">
              <!-- Month View -->
              <div id="month-view" class="calendar-view calendar-view--active">
                <div class="calendar-month">
                  <div class="calendar-month__weekdays" role="row">
                    <div class="calendar-month__weekday" role="columnheader">Sun</div>
                    <div class="calendar-month__weekday" role="columnheader">Mon</div>
                    <div class="calendar-month__weekday" role="columnheader">Tue</div>
                    <div class="calendar-month__weekday" role="columnheader">Wed</div>
                    <div class="calendar-month__weekday" role="columnheader">Thu</div>
                    <div class="calendar-month__weekday" role="columnheader">Fri</div>
                    <div class="calendar-month__weekday" role="columnheader">Sat</div>
                  </div>
                  <div class="calendar-month__grid" id="calendar-month-grid" role="grid"></div>
                </div>
              </div>

              <!-- Week View -->
              <div id="week-view" class="calendar-view" hidden>
                <div class="calendar-week">
                  <div class="calendar-week__timeline">
                    <div class="calendar-week__time-column" id="week-time-column"></div>
                    <div class="calendar-week__days" id="week-days-container"></div>
                  </div>
                </div>
              </div>

              <!-- Agenda View -->
              <div id="agenda-view" class="calendar-view" hidden>
                <div class="calendar-agenda" id="calendar-agenda-list"></div>
              </div>
            </div>
          </section>

          <!-- Upcoming Events Sidebar -->
          <section class="dashboard-card dashboard-card--upcoming-events" aria-labelledby="upcomingEventsTitle">
            <div class="dashboard-card__header">
              <div class="dashboard-card__title-group">
                <h2 class="dashboard-card__title" id="upcomingEventsTitle">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M12 2v20M2 12h20"></path></svg>
                  Upcoming
                </h2>
                <span class="dashboard-card__badge" id="upcoming-count">0</span>
              </div>
            </div>
            <div class="dashboard-card__content">
              <div class="upcoming-events" id="upcoming-events-list"></div>
            </div>
          </section>

          <!-- Mini Calendar -->
          <section class="dashboard-card dashboard-card--mini-calendar" aria-labelledby="miniCalendarTitle">
            <div class="dashboard-card__header">
              <div class="dashboard-card__title-group">
                <h2 class="dashboard-card__title" id="miniCalendarTitle">Quick Jump</h2>
              </div>
              <div class="calendar-nav calendar-nav--mini">
                <button class="calendar-nav__button" id="mini-calendar-prev" aria-label="Previous month"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg></button>
                <button class="calendar-nav__button" id="mini-calendar-next" aria-label="Next month"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg></button>
              </div>
            </div>
            <div class="dashboard-card__content">
              <div class="mini-calendar" id="mini-calendar"></div>
            </div>
          </section>
        </div>
      </main>
    </div>
  </div>

  <!-- FAB Button -->
  <button id="add-event-fab" class="fab-button" aria-label="Add Event" title="Add Event">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
  </button>

  <!-- Event Modal -->
  <div id="event-modal-overlay" class="modal-overlay" hidden></div>
  <div id="event-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="event-modal-title" hidden>
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="event-modal-title">Add Event</h2>
        <button type="button" class="icon-button modal-close" data-close-modal="event-modal" aria-label="Close event form">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
      </div>
      <form id="event-form" class="modal-form">
        <input type="hidden" id="event-form-id">
        <div class="form-group">
          <label for="event-title-input">Title</label>
          <input id="event-title-input" name="title" type="text" required placeholder="Event title">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="event-type">Type</label>
            <select id="event-type" name="type" required>
              <option value="task">Assignment</option>
              <option value="class">Class</option>
              <option value="exam">Exam</option>
              <option value="study">Study Session</option>
              <option value="personal">Personal</option>
            </select>
          </div>
          <div class="form-group">
            <label for="event-subject">Subject</label>
            <input id="event-subject" name="subject" type="text" placeholder="e.g., Mathematics">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="event-date">Date</label>
            <input id="event-date" name="date" type="date" required>
          </div>
          <div class="form-group">
            <label for="event-time">Time</label>
            <input id="event-time" name="time" type="time">
          </div>
        </div>
        <div class="form-group">
          <label for="event-duration">Duration (minutes)</label>
          <input id="event-duration" name="duration" type="number" min="5" step="5" placeholder="60">
        </div>
        <div class="form-group">
          <label for="event-description">Description</label>
          <textarea id="event-description" name="description" rows="3" placeholder="Event details..."></textarea>
        </div>
        <div class="form-group">
          <label for="event-location">Location</label>
          <input id="event-location" name="location" type="text" placeholder="Room or online link">
        </div>
        <div class="form-group form-group--checkbox">
          <label>
            <input type="checkbox" id="event-all-day" name="allDay">
            <span>All day event</span>
          </label>
        </div>
        <div class="form-group">
          <label for="event-color">Color</label>
          <div class="color-picker">
            <input type="color" id="event-color" name="color" value="#3b82f6">
            <div class="color-presets" id="color-presets"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="secondary-button" data-close-modal="event-modal">Cancel</button>
          <button type="submit" class="primary-button" id="event-form-submit">Save Event</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Event Detail Modal -->
  <div id="event-detail-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="event-detail-title" hidden>
    <div class="modal-content">
      <div class="modal-header">
        <div>
          <h2 id="event-detail-title">Event Details</h2>
          <p class="modal-subtitle" id="event-detail-subtitle"></p>
        </div>
        <button type="button" class="icon-button modal-close" data-close-modal="event-detail-modal" aria-label="Close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="event-detail">
          <div class="event-detail__section">
            <h3 class="event-detail__label">Time</h3>
            <p class="event-detail__value" id="event-detail-time">—</p>
          </div>
          <div class="event-detail__section">
            <h3 class="event-detail__label">Type</h3>
            <p class="event-detail__value"><span class="event-type-badge" id="event-detail-type">—</span></p>
          </div>
          <div class="event-detail__section" id="event-detail-subject-section">
            <h3 class="event-detail__label">Subject</h3>
            <p class="event-detail__value" id="event-detail-subject">—</p>
          </div>
          <div class="event-detail__section" id="event-detail-location-section">
            <h3 class="event-detail__label">Location</h3>
            <p class="event-detail__value" id="event-detail-location">—</p>
          </div>
          <div class="event-detail__section" id="event-detail-description-section">
            <h3 class="event-detail__label">Description</h3>
            <p class="event-detail__value" id="event-detail-description">—</p>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="danger-button" id="delete-event-btn">Delete</button>
        <button type="button" class="secondary-button" id="edit-event-btn">Edit</button>
        <button type="button" class="primary-button" data-close-modal="event-detail-modal">Close</button>
      </div>
    </div>
  </div>

  <!-- Chatbot + Modals (same as before) -->
  <div id="chatbot-modal" class="chatbot-modal" role="dialog" aria-labelledby="chatbot-title" aria-modal="true" hidden>
    <div class="chatbot-container chatbot-modal__container">
      <div class="chatbot-header chatbot-modal__header">
        <div class="chatbot-title-section chatbot-modal__title-section"><div class="mentor-avatar chatbot-modal__avatar"><svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path></svg></div><div><h2 id="chatbot-title">Smart Mentor</h2><span class="chatbot-status chatbot-modal__status">Online</span></div></div>
        <div class="chatbot-header__actions"><button id="reset-chat" class="icon-button chatbot-modal__reset-button" aria-label="Reset conversation"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg></button><button id="close-chatbot" class="close-button chatbot-modal__close-button" aria-label="Close chatbot"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div>
      </div>
      <div id="chatbot-messages" class="chatbot-messages chatbot-modal__messages" role="log" aria-live="polite" aria-atomic="false"></div>
      <div id="chat-aria-live" class="sr-only" aria-live="polite" aria-atomic="true"></div>
      <div class="chatbot-input-container chatbot-modal__input-container">
        <form id="chatbot-form" class="chatbot-input-form chatbot-modal__form">
          <textarea id="chatbot-input" class="chatbot-input chatbot-modal__input" placeholder="Type your message..." rows="1" aria-label="Chat message input" autocomplete="off"></textarea>
          <button type="submit" id="send-button" class="send-button chatbot-modal__send-button" aria-label="Send message" disabled><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg></button>
        </form>
      </div>
    </div>
  </div>
  <div id="chatbot-overlay" class="chatbot-overlay" hidden></div>

  <!-- Scripts - Load backend-integrated version -->
  <script src="public/js/api.js"></script>
  <script src="public/js/chatbot.js"></script>
  <script src="public/js/modules/utils.js"></script>
  <script src="public/js/modules/nav.js"></script>
  <script src="public/js/calendar-backend.js"></script>
  <script src="script.js"></script>
</body>
</html>
